""" 
This script contains
1. The libraries used in Julia. 
2. Calling of the script "extract_data". See what it does in its own file.
3. Functions mm and sat for michales menten kinetics and a saturation for enzimatic activity
4. Function build model: 
 is like the original build model. However, instead of having the degradations as
independent parameters, we symbolically solve for degradation values that make sure fold change
in the absence of amastigote is 1.
"""

using ModelingToolkit, OrdinaryDiffEq, BSON
include("extract_data.jl")


function mm(enzyme, substrate, velocity, mich_const)
    return velocity*enzyme*(substrate/(mich_const + substrate))
end

function sat(velocity, substrate, offset)
    return velocity*(substrate/(offset+substrate))
end

function build_model(initial_leish_promas; name)
    @parameters t 
    D = Differential(t)
    @variables Leish_promas(t) TLR4(t) TLR4a(t) NOTCH3(t) TRAF6(t) MAP4K3(t) NFkB(t) IL1B(t) TNFA(t) CREB(t) IL10(t) STAT3(t) NLRP12(t) CCL24(t) TIGAR(t) FOS(t) NADP_oxi(t) ROS_cytos(t) 
    @variables Leish_amas(t) P2RX7(t) P2RX7a(t) NFE2L2(t) Glutathione(t) PANX(t) PANXa(t) ATP_ext(t) NT5E(t) Adenosine(t) ADORA2B(t) ADORA2Ba(t) ATP_cytos(t) Glycolysis(t) Pyruvate(t) 
    @variables Succinate(t) TCA(t) QH2(t) ATP_Mito(t) ROS_Mito(t) HIF1A(t) Lactate(t)                      
    @parameters p1 p2 p4 p5 p6 p7 p8 p9 p10 p11 p12 p13 p14 p15 p16 p17 p18 p19 p20 p21 p22 p23 p24 p25 p26 p27 p28 p29 p30 p31 p32 p33 p34 p35 p36 p37 p38 p39 p40 p41 p42 p43 p44 
    @parameters p64 p3  p45 p46 p47 p48 p49 p50 p51 p52 p53 p54 p55 p56 p57 p60 p61 p62 p63 p65 p68 c_AKT2 c_TRAF6 c_MAP4K3  
    @parameters p14  
    @parameters c_TIFAB c_TP53INP1 c_ROS_cytos d_ROS_cytos c_Leish_amas d_Leish_amas c_P2RX7 d_P2RX7  
    @parameters c_Glutathione c_ATP_ext_tr c_Adenosine c_ATP_cytos c_Pyruvate 
    @parameters o_ATP_Mito o_ROS_Mito d_ROS_Mito  
    @parameters tftf c_PT nftf d_TI nftf2 nftf3 k38 v38 kt4t6 kilp2r
    @parameters p45_prop p38_prop p44_prop p60_prop p37_prop p1_prop amas_param
    @parameters p5_effective p47_effective p43_effective kntr katppnx kadocreb
    @parameters c_TLR4 c_TLR4a c_NOTCH3 c_TRAF6 c_MAP4K3 c_NFkB c_IL1B c_TNFA c_CREB c_IL10 c_STAT3 c_NLRP12 c_CCL24 c_TIGAR c_FOS c_NADP_oxi c_P2RX7a c_NFE2L2 c_PANX c_PANXa 
    @parameters c_NT5E c_ADORA2B c_ADORA2Ba c_Glycolysis c_Succinate c_QH2 c_HIF1A c_Lactate
    @parameters d_TLR4 d_TLR4a d_NOTCH3 d_TRAF6 d_MAP4K3 d_NFkB d_IL1B d_TNFA d_CREB d_IL10 d_STAT3 d_NLRP12 d_CCL24 d_TIGAR d_FOS d_NADP_oxi d_P2RX7a d_NFE2L2 d_Glutathione d_PANX d_PANXa
    @parameters d_ATP_ext d_NT5E d_Adenosine d_ADORA2Ba d_ADORA2B d_ATP_cytos d_Glycolysis d_TP53INP1 d_ATP_ext_tr d_TCA d_QH2 d_ATP_Mito d_HIF1A d_Lactate d_Pyruvate d_Succinate
    @parameters lpst nftf4 k_PANXa  
    @parameters p65 p66 p67  p68 i_ADAd pcrebtr n_ext_tr
      

    maxvel = 100
    promas_param = Num.(-(1/24)*log(0.01))    
    eqs = [
        D(Leish_promas) ~ -promas_param*Leish_promas,
        D(TLR4) ~ c_TLR4 + p64*STAT3 - d_TLR4*TLR4,
        D(TLR4a) ~  c_TLR4a + 100*p2*sat(TLR4, Leish_promas, kntr) - d_TLR4a*TLR4a,
        D(NOTCH3) ~ c_NOTCH3 + p3*TLR4a - d_NOTCH3*NOTCH3,
        D(TRAF6) ~ c_TRAF6 + (0.001p5 - 0.1c_TRAF6 + 10p7)*TLR4a - d_TRAF6*TRAF6 - p7*NLRP12*TRAF6,
        D(MAP4K3) ~ c_MAP4K3 + p9*TRAF6 - d_MAP4K3*MAP4K3,
        D(NFkB) ~ c_NFkB + p10*MAP4K3 - p51*Leish_amas*NFkB - d_NFkB*NFkB,
        D(IL1B) ~ c_IL1B + p11*NFkB + p12*P2RX7a - d_IL1B*IL1B,
        D(TNFA) ~ c_TNFA + p13*NFkB - d_TNFA*TNFA,
        D(CREB) ~ c_CREB + p15*MAP4K3 + p16*ADORA2Ba - d_CREB*CREB,
        D(IL10) ~ c_IL10 + p17*CREB - d_IL10*IL10,
        D(STAT3) ~ c_STAT3 + p19*IL10 - lpst*STAT3*Leish_promas - d_STAT3*STAT3,
        D(NLRP12) ~ c_NLRP12 + p20*STAT3 - d_NLRP12*NLRP12,
        D(CCL24) ~ c_CCL24 + p22*STAT3 - d_CCL24*CCL24,
        D(TIGAR) ~ c_TIGAR + p24*CREB - d_TIGAR*TIGAR,
        D(FOS) ~ c_FOS + p26*MAP4K3 + p65*STAT3 - d_FOS*FOS,
        D(NADP_oxi) ~ c_NADP_oxi + (p27 + 10*p28)*FOS - p28*NOTCH3*NADP_oxi - d_NADP_oxi*NADP_oxi, 
        D(ROS_cytos) ~ nftf3*NADP_oxi*Leish_promas + nftf4*NADP_oxi*Leish_amas- p57*Glutathione*ROS_cytos,
        D(Leish_amas) ~ 0.096*Leish_promas,
        D(P2RX7) ~ c_P2RX7 + p32*STAT3 - d_P2RX7*P2RX7,
        D(P2RX7a) ~  c_P2RX7a + p33*sat(P2RX7, ATP_ext, kilp2r) - d_P2RX7a*P2RX7a,
        D(NFE2L2) ~ c_NFE2L2 + p34*NFkB + p35*ROS_Mito - d_NFE2L2*NFE2L2,
        D(Glutathione) ~ c_Glutathione + p36*NFE2L2 - d_Glutathione*Glutathione,
        D(PANX) ~ c_PANX + pcrebtr*CREB - n_ext_tr*ATP_ext*PANX - d_PANX*PANX,
        D(PANXa) ~ c_PANXa + k_PANXa*Leish_promas*sat(PANX, ATP_cytos, katppnx) - d_PANXa*PANXa,
        D(ATP_ext) ~  (p61)*PANXa - d_ATP_ext*ATP_ext ,
        D(NT5E) ~ c_NT5E + p68*NFkB + p66*STAT3 + p67*HIF1A - d_NT5E*NT5E,
        D(Adenosine) ~ mm(NT5E, ATP_ext, v38, k38) - d_Adenosine*Adenosine,
        D(ADORA2B) ~ c_ADORA2B + p68*HIF1A - d_ADORA2B*ADORA2B,
        D(ADORA2Ba) ~  c_ADORA2Ba + i_ADAd*sat(ADORA2B, Adenosine, kadocreb) - d_ADORA2Ba*ADORA2Ba,
        D(ATP_cytos) ~  p18*Glycolysis - d_ATP_cytos*ATP_cytos - p37*ATP_cytos*Leish_promas*PANX,
        D(Glycolysis) ~ c_Glycolysis - p41*TIGAR*Glycolysis + (p43 + 10p41 - 0.1c_Glycolysis)*HIF1A - d_Glycolysis*Glycolysis,
        D(Pyruvate) ~   (p44 + p45)*Glycolysis - p45*Pyruvate - p44*Pyruvate,
        D(Succinate) ~ c_Succinate + p45_prop*Pyruvate - p60*Succinate - d_Succinate*Succinate,
        D(TCA) ~   p60_prop*Succinate - p55*TCA*ROS_Mito - d_TCA*TCA,
        D(QH2) ~ c_QH2 + p46*Succinate - d_QH2*QH2,
        D(ATP_Mito) ~ o_ATP_Mito + (p47 + 10*p53 - 0.1*o_ATP_Mito)*QH2 - p48*ROS_Mito*ATP_Mito - p53*HIF1A*ATP_Mito - d_ATP_Mito*ATP_Mito,
        D(ROS_Mito) ~  p21*Leish_promas*Glycolysis - d_ROS_Mito*ROS_Mito,
        D(HIF1A) ~ c_HIF1A + p49*NFkB + p62*Succinate*Leish_promas - d_HIF1A*HIF1A,
        D(Lactate) ~ c_Lactate + p50*HIF1A + p44_prop*Pyruvate - d_Lactate*Lactate
    ]
     
# problems are states 15 and 18: TIFAB and NADP_oxi
# add p37 prop
     observed = [
        total_ROS ~ ROS_cytos + ROS_Mito,
        p5_effective ~ p5 + 10*(p7) - 0.1c_TRAF6 + 0.01,
        p47_effective ~ p47 + 10*p53 - 0.1*o_ATP_Mito,
        p43_effective ~ p43 + p41 - 0.1c_Glycolysis + 0.001
    ]

    od = ODESystem(eqs)
    defaults_ic = make_defaults(od)

    """
        substitute out degradation parameters so that initial conditions = steady state for 0 promastigote
    """
    function ss_degs(eqs)
        eqs2 = [0 ~ el.rhs for el in eqs]
        eqs2 = [el.lhs ~ Num(substitute(el.rhs, merge(defaults_ic, Dict(Leish_promas => 0))) ) for el in eqs2]
        d = Dict()
        for (i,el) in enumerate(eqs2)
            vars = Symbolics.get_variables(el)
            str_vars = String.(Symbolics.tosymbol.(vars))
            which_var = findfirst(x -> occursin("d_", x), str_vars) 
            if !(isnothing(which_var))           
                replace = Symbolics.solve_for(el, vars[which_var])
                #d[vars[which_var]] = ifelse(replace >= 0.0001, replace, 0.0001)
                d[vars[which_var]] = max(replace, 0.0001)
            end
        end
        d = collect(d)
        eqs3 = [el.lhs ~ substitute(el.rhs, d) for el in eqs]
        return eqs3
    end

    neweqs = ss_degs(eqs)
    

    # this has error 30 but dynamics have been checked:
    #defaults_p = Dict(c_TNFA => 1.0, p66 => 1.0, p7 => 1.0, c_MAP4K3 => 1.0, c_Glycolysis => 1.0, c_CCL24 => 1.0, p65 => 1.0, p27 => 1.0, p48 => 1.0, c_IL1B => 1.0, c_QH2 => 1.0, p44 => 1.0, p57 => 1.0, c_NLRP12 => 1.0, n_ext_tr => 1.0, c_ADORA2B => 1.0, p9 => 1.0, p25 => 1.0, c_ADORA2Ba => 1.0, p51 => 1.0, c_FOS => 1.0, p24 => 1.0, p55 => 1.0, p11 => 1.0, p34 => 1.0, p45 => 1.0, v38 => 1.0, c_IL10 => 1.0, c_TP53INP1 => 1.0, d_ROS_Mito => 1.0, c_P2RX7a => 1.0, p17 => 1.0, c_NT5E => 1.0, p67 => 1.0, c_PANXa => 1.0, p13 => 1.0, p18 => 1.0, p5 => 1.0, p10 => 1.0, p26 => 1.0, p28 => 1.0, kilp2r => 1.0, nftf3 => 1.0, p62 => 1.0, p12 => 1.0, kntr => 1.0, p43 => 1.0, p47 => 1.0, o_ATP_Mito => 1.0, p3 => 1.0, i_ADAd => 1.0, k38 => 1.0, p61 => 1.0, p19 => 1.0, p64 => 1.0, p22 => 1.0, p53 => 1.0, p45_prop => 1.0, p38 => 1.0, pcrebtr => 1.0, p46 => 1.0, c_NADP_oxi => 1.0, p33 => 1.0, c_CREB => 1.0, c_STAT3 => 1.0, p32 => 1.0, p49 => 1.0, c_NFE2L2 => 1.0, c_NOTCH3 => 1.0, c_TLR4 => 1.0, c_P2RX7 => 1.0, c_Glutathione => 1.0, p44_prop => 1.0, k_PANXa => 1.0, p20 => 1.0, c_HIF1A => 1.0, p35 => 1.0, c_PANX => 1.0, c_TRAF6 => 1.0, nftf4 => 1.0, c_Succinate => 1.0, p36 => 1.0, p60_prop => 1.0, c_TLR4a => 1.0, katppnx => 1.0, c_NFkB => 1.0, p15 => 1.0, lpst => 1.0, p68 => 1.0, p60 => 1.0, p21 => 1.0, p2 => 1.0, p37 => 1.0, kadocreb => 1.0, p16 => 1.0, c_Lactate => 1.0, p41 => 1.0, p50 => 1.0)
    #defaults_p = Dict(c_TNFA => 0.3863989916849274, p66 => 0.030051058510145195, p7 => 2.3320633095502794, c_MAP4K3 => 0.05095198119061171, c_Glycolysis => 0.6724104009455666, c_CCL24 => 0.0037953855629786317, p65 => 0.00036674134691498504, p27 => 4.972208088462476, p48 => 0.01598665844654567, c_IL1B => 0.1374782549341758, c_QH2 => 0.017978599144461812, p44 => 0.2832362140491397, p57 => 0.5257425557599061, p63 => 0.18108943521580617, c_NLRP12 => 0.07296050650652267, n_ext_tr => 0.09270239682711866, c_ADORA2B => 13.485268635826227, p9 => 17.83251161672511, p25 => 16.916943585100707, c_ADORA2Ba => 0.4077810596793367, p51 => 0.7703482633313499, c_FOS => 0.004091108450438003, p24 => 0.97647008641129, p55 => 0.13655883877927805, p11 => 0.4928577273699802, p34 => 8.52438940254528, p45 => 0.2832221740226205, v38 => 1.9976811938486316, c_IL10 => 0.04402047080103718, c_TP53INP1 => 0.4722281057052898, d_ROS_Mito => 0.10864011554687603, c_P2RX7a => 0.0660586433631917, p17 => 320.9254314222795, c_NT5E => 0.11156291060940997, p67 => 0.22759496022092227, c_PANXa => 8.384050709490328, p13 => 0.8856386041190962, p18 => 1.502617621287222, p5 => 0.32117129552587376, p10 => 0.4752237810007457, p26 => 0.6381581424737035, p28 => 0.013767747661826518, nftf3 => 0.5257425557598896, p62 => 2.80988592207474, p12 => 0.01901994340301129, kntr => 370.49830553871897, p43 => 0.05928947612235657, p47 => 100.6190728909961, o_ATP_Mito => 0.47455176251059966, p3 => 0.20930343269493004, i_ADAd => 0.04489486284139712, k38 => 0.39720362451253266, p61 => 0.1195075439965554, p19 => 0.1985132136015057, p64 => 0.028850283037740218, p22 => 0.18426817898716874, p53 => 0.1034425002463817, p45_prop => 20.759535797324972, p38 => 4.085773019788546, pcrebtr => 3.906527791386378, p46 => 0.020768620980111313, c_NADP_oxi => 2.595574592038308, p33 => 85.98897775043906, c_CREB => 0.5234407153991477, c_STAT3 => 0.013285195390098472, p32 => 1.4956613245490293, p49 => 0.17019795172467755, c_NFE2L2 => 0.6880766556185248, c_NOTCH3 => 0.12980587905478438, c_TLR4 => 0.10574414140172318, kt4t6 => 188.38755171479963, c_P2RX7 => 2.1928491306989564, c_Glutathione => 13.304066927134924, p44_prop => 5.202062188998153, p20 => 0.1852636962291145, c_HIF1A => 0.0859943087306622, p35 => 14.741849113509229, c_PANX => 0.3739497271127834, c_TRAF6 => 0.43890180449811805, nftf4 => 0.49219416591740295, c_Succinate => 0.32455587256539, p36 => 0.48474203920054193, p60_prop => 3.9347371881077575, c_TLR4a => 1.861501922942313, c_NFkB => 0.19448621038856095, p15 => 0.014812891793600203, lpst => 5.127577680472929, p68 => 0.07481781085869857, p60 => 0.1715866652160257, p21 => 0.12542704910089014, p2 => 378.43269926740766, p37 => 3.0029644756822704, p16 => 1.299373923614943, c_Lactate => 1.1350075242784323, p41 => 3.307451546338581, p50 => 0.008569121163504749)    
    #defaults_p = Dict(c_TNFA => 0.36746453129492623, p66 => 0.03637965649688459, p7 => 4.89739545104999, c_MAP4K3 => 0.05371447331850213, c_Glycolysis => 0.6849295672142386, c_CCL24 => 0.0031835722798071874, p65 => 0.0003863582679946913, p27 => 5.837197032164152, p48 => 0.01708268341854802, c_IL1B => 0.1344586049603566, c_QH2 => 0.02282173815637926, p44 => 0.1035571507515823, p57 => 0.5354163664215913, c_NLRP12 => 0.14201128356933068, n_ext_tr => 0.0454548524396994, c_ADORA2B => 36.50438366217374, p9 => 54.95060911079297, p25 => 23.410859440337678, c_ADORA2Ba => 0.08076857366790145, p51 => 0.20753940115895617, c_FOS => 0.005660641654016884, p24 => 0.7694767404524684, p55 => 0.21488446743500675, p11 => 0.45812823576097733, p34 => 5.5982606337008445, p45 => 0.10355791524162937, v38 => 2.5989274217047837, c_IL10 => 0.04476496115925921, c_TP53INP1 => 0.4868070531136862, d_ROS_Mito => 0.14508447875721467, c_P2RX7a => 0.06763034156466395, p17 => 342.3067467339205, c_NT5E => 0.11250265770493519, p67 => 0.05915692903846109, c_PANXa => 0.1567858032531754, p13 => 0.8055725101882408, p18 => 2.245901989364076, p5 => 0.4395132342574454, p10 => 0.1997966156145523, p26 => 0.18467340118782374, p28 => 0.012803159363315435, kilp2r => 0.987534936375665, nftf3 => 0.5354163664215745, p62 => 10.277477163995949, p12 => 0.01450906898986542, kntr => 2.2544589010142277, p43 => 0.06063169265796228, p47 => 123.27780992590928, o_ATP_Mito => 0.490148188631257, p3 => 0.039657047395630744, i_ADAd => 0.5568870282277143, k38 => 0.40136947442534093, p61 => 0.12399101852712517, p19 => 0.1484036882109394, p64 => 0.24432765127200984, p22 => 0.1727926445444327, p53 => 0.0816964337356083, p45_prop => 22.301148742187415, p38 => 0.2856664603131766, pcrebtr => 0.9233793867078668, p46 => 0.03245974179965317, c_NADP_oxi => 3.067377616751986, p33 => 85.7720416859779, c_CREB => 0.23263794689939357, c_STAT3 => 0.011233761820727368, p32 => 1.2945835922704334, p49 => 0.22095377155119447, c_NFE2L2 => 0.6969142256995122, c_NOTCH3 => 0.0014826718913018982, c_TLR4 => 0.05627934028949736, c_P2RX7 => 2.7539213608622113, c_Glutathione => 24.569490148447915, p44_prop => 3.8814779398014956, k_PANXa => 1.139738545049891, p20 => 0.00044987003632342165, c_HIF1A => 0.08966140128921922, p35 => 16.56100999593901, c_PANX => 0.5922564170168046, c_TRAF6 => 0.5333809496182963, nftf4 => 0.5013277957526981, c_Succinate => 0.33558179260171195, p36 => 0.2979456680287546, p60_prop => 2.6604571159741317, c_TLR4a => 131.1466335336481, katppnx => 0.7007582478068177, c_NFkB => 0.17608606949908012, p15 => 0.023453585150610887, lpst => 5.0237285194075225, p68 => 0.08573114510570749, p60 => 0.17521256237507038, p21 => 0.1768686511103264, p2 => 1096.6323544981076, p37 => 2.1425252922114364, kadocreb => 6.642128091472889, p16 => 0.41677417312752657, c_Lactate => 1.1477948957066475, p41 => 3.262892388663727, p50 => 0.007081469696992451)
    #defaults_p = Dict(c_TNFA => 0.1767611399094157, p66 => 0.05361534047604174, p7 => 0.003362341592142349, c_MAP4K3 => 0.030890669471383348, c_Glycolysis => 0.38570974319980916, c_CCL24 => 0.001330221994702603, p65 => 0.006280462245713321, p27 => 0.05373266374635937, p48 => 0.01149643318097456, c_IL1B => 0.06637001853991845, c_QH2 => 0.03642157702631775, p44 => 0.6074357420548614, p57 => 0.2960050402430405, c_NLRP12 => 0.0017816314403786902, n_ext_tr => 0.03424204647798542, c_ADORA2B => 1.824284665062376, p9 => 124.36624139145682, p55 => 0.07350608029900185, c_ADORA2Ba => 0.029566512734363348, p51 => 0.12864678818997985, c_FOS => 0.03567017895745272, p24 => 0.24358995786509308, p11 => 0.8829180799327153, p34 => 0.6802462909133038, p45 => 0.6046897306939572, v38 => 5.884232207578334, c_IL10 => 0.024374994127968924, d_ROS_Mito => 0.20442777963142822, c_P2RX7a => 0.03765425722168221, p17 => 9.991059684978575, c_NT5E => 0.05087681682192972, p67 => 0.4063241725195442, c_PANXa => 0.07246736409508744, p13 => 0.9789094153684944, p18 => 1.6891848932294098, p5 => 118.03673027152195, p10 => 1.446606822792664, p26 => 0.07425117092585881, p28 => 0.013950236777145969, kilp2r => 0.521722896191573, nftf3 => 0.2960050402430311, p62 => 0.38275442120541175, p12 => 0.004867169352730581, kntr => 0.2519448137307232, p43 => 0.3022245775587142, p47 => 84.45610210439197, o_ATP_Mito => 0.290416383302453, p3 => 0.03947224130022223, i_ADAd => 1.410756197765475, k38 => 0.0802923020601361, c_TIGAR => 0.0009996664083070507, p61 => 0.056380943288869924, p19 => 0.1529630782991249, p64 => 2.4550756726114535, p22 => 0.15837185130335385, p53 => 0.029874697898231887, p45_prop => 14.426348965704479, p38 => 0.05441208600788493, pcrebtr => 0.5076757642981493, p46 => 0.011102176144185542, c_NADP_oxi => 1.7806147492531332, p33 => 46.55739280296974, c_CREB => 0.058453686070727345, c_STAT3 => 0.003599320095658645, p32 => 0.4662310346376068, p49 => 0.43820771906611117, c_NFE2L2 => 0.3924782441259982, c_NOTCH3 => 0.0003356744700283312, c_TLR4 => 0.029484309686031288, c_P2RX7 => 2.723029051738387, c_Glutathione => 20.94477841471598, p44_prop => 0.03891898396070719, k_PANXa => 0.9234770060245007, p20 => 0.15846075300050252, c_HIF1A => 9.999313598475212e-5, p35 => 6.406446315424809, c_PANX => 0.2459725741846972, c_TRAF6 => 0.8155502547072051, nftf4 => 0.27721183610481825, c_Succinate => 0.19301283566141567, p36 => 0.10317180045030112, p60_prop => 2.399375647915452, c_TLR4a => 37.86843560636829, katppnx => 0.2909191743591382, c_NFkB => 0.15826529104708723, p15 => 0.03603119167717309, lpst => 7.04161098776715, p68 => 0.006222635382818149, p60 => 0.09720027605300285, p21 => 0.033485473831548075, p2 => 18.597270430801295, p37 => 0.9312576315069472, kadocreb => 22.93243579516541, p16 => 0.26577489668393117, c_Lactate => 0.4961447271359112, p41 => 1.7675944568277355, p50 => 0.0006936833297676446)
    #extra_ps = Dict(c_TNFA => 1.0, p66 => 1.0, p7 => 1.0, c_MAP4K3 => 1.0, c_Glycolysis => 1.0, c_CCL24 => 1.0, p65 => 1.0, p27 => 1.0, p48 => 1.0, c_IL1B => 1.0, c_QH2 => 1.0, p44 => 1.0, p57 => 1.0, c_NLRP12 => 1.0, n_ext_tr => 1.0, c_ADORA2B => 1.0, p9 => 1.0, p25 => 1.0, p55 => 1.0, p51 => 1.0, c_FOS => 1.0, p24 => 1.0, p11 => 1.0, p34 => 1.0, p45 => 1.0, v38 => 1.0, c_IL10 => 1.0, c_TP53INP1 => 1.0, d_ROS_Mito => 1.0, p17 => 1.0, c_NT5E => 1.0, p67 => 1.0, c_PANXa => 1.0, p13 => 1.0, p18 => 1.0, p5 => 1.0, p10 => 1.0, p26 => 1.0, p28 => 1.0, kilp2r => 1.0, nftf3 => 1.0, p62 => 1.0, p12 => 1.0, kntr => 1.0, p43 => 1.0, p47 => 1.0, o_ATP_Mito => 1.0, p3 => 1.0, i_ADAd => 1.0, k38 => 1.0, p61 => 1.0, p19 => 1.0, p64 => 1.0, p22 => 1.0, p53 => 1.0, p45_prop => 1.0, p38 => 1.0, pcrebtr => 1.0, p46 => 1.0, c_NADP_oxi => 1.0, p33 => 1.0, c_CREB => 1.0, c_STAT3 => 1.0, p32 => 1.0, p49 => 1.0, c_NFE2L2 => 1.0, c_NOTCH3 => 1.0, c_TLR4 => 1.0, kt4t6 => 1.0, c_P2RX7 => 1.0, c_Glutathione => 1.0, p44_prop => 1.0, p20 => 1.0, c_HIF1A => 1.0, p35 => 1.0, c_PANX => 1.0, c_TRAF6 => 1.0, nftf4 => 1.0, c_Succinate => 1.0, p36 => 1.0, p60_prop => 1.0, katppnx => 1.0, c_NFkB => 1.0, p15 => 1.0, lpst => 1.0, p68 => 1.0, p60 => 1.0, p21 => 1.0, p2 => 1.0, p37 => 1.0, kadocreb => 1.0, p16 => 1.0, c_Lactate => 1.0, p41 => 1.0, p50 => 1.0)
    #defaults_p = Dict(c_TNFA => 0.17711069487463885, p66 => 0.04849702735458906, p7 => 0.00331250961981994, c_MAP4K3 => 0.030890621464169734, c_Glycolysis => 0.3860398317472236, c_CCL24 => 0.0013302073600111074, p65 => 0.006238013016637023, p27 => 0.053739079484785075, p48 => 0.011500540899873261, c_IL1B => 0.06640260521540217, c_QH2 => 0.03652462660131678, p44 => 0.6916583914653044, p57 => 0.2960050402430405, c_NLRP12 => 0.0017816169967584164, n_ext_tr => 0.03398967644505904, c_ADORA2B => 1.7691380427530543, p9 => 124.70832580128923, p55 => 0.07350082280251312, c_ADORA2Ba => 0.02954317115226186, p51 => 0.13435845686444034, c_FOS => 0.03558235880850039, p24 => 0.3095041261961973, p11 => 0.8859758625402191, p34 => 0.682694732744293, p45 => 0.688637303290571, v38 => 5.942095443579796, c_IL10 => 0.02437419687702852, d_ROS_Mito => 0.2051345926074583, c_P2RX7a => 0.03765425728675758, p17 => 10.016672399300923, c_NT5E => 0.05036057829416502, p67 => 0.45404438947824877, c_PANXa => 0.07247157148769658, p13 => 0.9854556665170479, p18 => 1.6892029428782174, p5 => 131.2334011019076, p10 => 1.5065867967115907, p26 => 0.09831666719755451, p28 => 0.013952254989386018, kilp2r => 0.5217207373157222, nftf3 => 0.2960050402430311, p62 => 0.9002832409799281, p12 => 0.00486882208946424, kntr => 0.25273808174423157, p43 => 0.3007817519465013, p47 => 84.1137387307853, o_ATP_Mito => 0.290422353761523, p3 => 0.03946873202158752, i_ADAd => 1.6906896247539525, k38 => 0.08029240452830337, c_TIGAR => 0.000999627511595467, p61 => 0.05637770548219331, p19 => 0.15505782944384988, p64 => 3.0243155457606767, p22 => 0.15868156209290524, p53 => 0.029983675122442082, p45_prop => 15.264757911887193, p38 => 0.05441178443016183, pcrebtr => 0.5114996328746614, p46 => 0.010192647928840089, c_NADP_oxi => 1.7801604216979987, p33 => 46.55738689967973, c_CREB => 0.05827312651583343, c_STAT3 => 0.0035992629853510774, p32 => 0.4661212726338868, p49 => 0.4848237065069543, c_NFE2L2 => 0.3925610657810263, c_NOTCH3 => 0.00033566824199613267, c_TLR4 => 0.029440505529164936, c_P2RX7 => 2.723858080202736, c_Glutathione => 21.023334809171164, p44_prop => 0.03328571615155131, k_PANXa => 0.9230112030990916, p20 => 0.15445679709942917, c_HIF1A => 9.999311453420683e-5, p35 => 6.382427226260181, c_PANX => 0.2459712553696118, c_TRAF6 => 0.9542685942334399, nftf4 => 0.27721183610481825, c_Succinate => 0.1929468818062953, p36 => 0.10280460031485177, p60_prop => 2.3995822521276327, c_TLR4a => 46.097144663823116, katppnx => 0.29091523254149654, c_NFkB => 0.15869490594327212, p15 => 0.04107686815335002, lpst => 7.1042423762035405, p68 => 0.007174729517102754, p60 => 0.09720027605300285, p21 => 0.03337078831630774, p2 => 16.667358501262584, p37 => 0.9312407932940622, kadocreb => 25.405741658870983, p16 => 0.3091826197724708, c_Lactate => 0.5095557168296283, p41 => 1.8697657117343178, p50 => 0.0006908837641331995)
    #defaults_p = Dict(c_TNFA => 0.17975930355471392, p66 => 0.04146941146224397, p7 => 0.00347739104494993, c_MAP4K3 => 0.03089031300224356, c_Glycolysis => 0.3871795876298925, c_CCL24 => 0.0013301502645599304, p65 => 0.0062086750329958095, p27 => 0.05373935866599848, p48 => 0.011514302084945669, c_IL1B => 0.0666970604766642, c_QH2 => 0.03668078908952797, p44 => 0.6814653106936295, p57 => 0.2960050402430405, c_NLRP12 => 0.0017814937081435888, n_ext_tr => 0.03445681156921722, c_ADORA2B => 1.6660336612982305, p9 => 124.52816840125193, p55 => 0.07346670911210172, c_ADORA2Ba => 0.029521023020557393, p51 => 0.19253092800232163, c_FOS => 0.03547669938410313, p24 => 0.4909741890972337, p11 => 1.0151347556165964, p34 => 0.6751611423361109, p45 => 0.6236429574265421, v38 => 6.020053073557553, c_IL10 => 0.02437007529368425, d_ROS_Mito => 0.20046107531906976, c_P2RX7a => 0.037654257683119176, p17 => 10.128063836309305, c_NT5E => 0.04932887957502133, p67 => 0.48501436582745355, c_PANXa => 0.07965209452378741, p13 => 1.198025303330845, p18 => 1.5265998727437113, p5 => 503.5179459604146, p10 => 1.4676698094881189, p26 => 3.1659476464309972, p28 => 0.013951782636768911, kilp2r => 0.5217053489518926, nftf3 => 0.2960050402430311, p62 => 0.8968309755381589, p12 => 0.004884019094212435, kntr => 0.2535458916505562, p43 => 0.29713889196713295, p47 => 82.85466125586021, o_ATP_Mito => 0.2904390760575986, p3 => 0.03943270393398044, i_ADAd => 2.1105477363211516, k38 => 0.08028849361610503, c_TIGAR => 0.0009995439944869074, p61 => 0.03452108673111673, p19 => 0.1604621023902813, p64 => 3.4885871513198237, p22 => 0.15887864141375066, p53 => 0.03039703162131277, p45_prop => 14.676937883788932, p38 => 0.06652820291398702, pcrebtr => 0.4692656095992321, p46 => 0.008328147122572457, c_NADP_oxi => 1.7802046630661301, p33 => 46.55729102878987, c_CREB => 0.05806480405379733, c_STAT3 => 0.0035994600288374477, p32 => 0.4654445770264566, p49 => 0.46139323119605863, c_NFE2L2 => 0.3923296749979879, c_NOTCH3 => 0.0003356188013935616, c_TLR4 => 0.029391928459224545, c_P2RX7 => 2.7297555930106894, c_Glutathione => 20.929875025560126, p44_prop => 0.02719833008819133, k_PANXa => 0.4265909994663172, p20 => 0.14397872489607594, c_HIF1A => 9.99932232892315e-5, p35 => 6.444374471235346, c_PANX => 0.24631352314313723, c_TRAF6 => 1.0856191855466273, nftf4 => 0.27721183610481825, c_Succinate => 0.1930733572476043, p36 => 0.10324460698727161, p60_prop => 2.4024083047322713, c_TLR4a => 53.68528832683435, katppnx => 0.3234131122217047, c_NFkB => 0.16211989126778203, p15 => 0.050189084898047756, lpst => 7.203339703914291, p68 => 0.009084249409135063, p60 => 0.09720027605300285, p21 => 0.03372348378988695, p2 => 14.835035161909122, p37 => 1.0366846759704484, kadocreb => 28.268271738270577, p16 => 0.35696779147163255, c_Lactate => 0.5237386625388621, p41 => 1.8771520222392082, p50 => 0.0006856397500372056)
    #defaults_p = Dict(c_TNFA => 0.1814258867356213, p66 => 0.042027433221538034, p7 => 0.0033284230714385574, c_MAP4K3 => 0.030890232233176718, c_Glycolysis => 0.3875665439829342, c_CCL24 => 0.0013300569136250066, p65 => 1.552147163002708, p27 => 0.05376723262255874, p48 => 0.01152682675977769, c_IL1B => 0.0669087056495024, c_QH2 => 0.03661577766877555, p44 => 0.6517202893358072, p57 => 0.2960050402430405, c_NLRP12 => 0.001781091761553891, n_ext_tr => 0.04068087800969241, c_ADORA2B => 1.5402406158161726, p9 => 124.5030938421791, p55 => 0.07340333556044579, c_ADORA2Ba => 0.029532205413446033, p51 => 0.2517098425390775, c_FOS => 0.03541381858053405, p24 => 0.5652135234570714, p11 => 1.283428269502713, p34 => 0.6629223760853721, p45 => 0.581984778419766, v38 => 5.986564665187524, c_IL10 => 0.0243607523494414, d_ROS_Mito => 0.19744272804092136, c_P2RX7a => 0.03765425866554161, p17 => 10.27129358612894, c_NT5E => 0.04904093801957056, p67 => 0.43121120082095793, c_PANXa => 0.07898872200758408, p13 => 1.5903908236951145, p18 => 1.6683553309715744, p5 => 690.4073925885663, p10 => 1.7158539411167801, p26 => 3.1841318457211183, p28 => 0.01395899024894111, kilp2r => 0.5217026711760238, nftf3 => 0.2960050402430311, p62 => 0.8871942716964241, p12 => 0.004893849556692361, kntr => 0.25252642511355355, p43 => 0.2958447055203806, p47 => 81.59322052917808, o_ATP_Mito => 0.29045104373256353, p3 => 0.039393007435949555, i_ADAd => 1.73683662806926, k38 => 0.08030151899540758, c_TIGAR => 0.000999509609427984, p61 => 0.03656576215791962, p19 => 0.19825398405528083, p64 => 3.150059453654233, p22 => 0.1585557542912583, p53 => 0.030827967689970634, p45_prop => 14.258287219947626, p38 => 3.8906653882865605, pcrebtr => 0.36786417840629987, p46 => 0.007608561509895629, c_NADP_oxi => 1.7784436013812575, p33 => 46.55723092054029, c_CREB => 0.05821234522774008, c_STAT3 => 0.0035981845275884668, p32 => 0.4652166579412617, p49 => 0.4786077766009755, c_NFE2L2 => 0.3918705344259958, c_NOTCH3 => 0.0003355288387606736, c_TLR4 => 0.029390866643912134, c_P2RX7 => 2.7316780901486326, c_Glutathione => 20.598905369528573, p44_prop => 0.028865648753695336, k_PANXa => 0.8110647026511407, p20 => 0.1417725675635281, c_HIF1A => 9.999369284344499e-5, p35 => 6.561125323011353, c_PANX => 0.2505212871576976, c_TRAF6 => 1.1138795301896367, nftf4 => 0.27721183610481825, c_Succinate => 0.1931718521186983, p36 => 0.10481089147313004, p60_prop => 2.40824850445663, c_TLR4a => 47.78775687022008, katppnx => 0.2949703046396298, c_NFkB => 0.16443798941335833, p15 => 0.05108021520987055, lpst => 7.174695904751697, p68 => 0.00913616807213434, p60 => 0.09720027605300285, p21 => 0.034342767887521754, p2 => 17.370684334921812, p37 => 0.9448620300196116, kadocreb => 26.234598137763793, p16 => 0.31799599600571954, c_Lactate => 0.5075307406103945, p41 => 1.8874911094730316, p50 => 0.0006891639757586079)
    

     #extra_ps = Dict(p26 => 50., p65 => 0.1)
    extra_ps = Dict()
    defaults_p = merge(defaults_p, extra_ps)
    defaults = merge(defaults_ic, defaults_p)
    defaults[Leish_promas] = initial_leish_promas
    od = ODESystem(neweqs, observed = observed, defaults = defaults; name = name)
    return od
end
build_model(;name) = build_model(10.;name)

@named leish_model_pre = build_model(10.)
leish_model = structural_simplify(leish_model_pre)
tspan = (0., 26.)
# p0 = [1.1217151537225205, 0.8003702342783656, 1.7468980609188565, 1.0013060548602024, 0.9897096536489669, 0.05840669850478811, 0.049343207944012, 1.1694346858977744, 1.0171174338747282, 0.9714633892410804, 1.3306227804745294, 1.0064241144026753, 0.9794050487566803, 0.9973831609255331, 1.2354815053330148, 0.7675208401274283, 1.0252800837676617, 1.0896679074428415, 0.9925105545297355, 1.0044127062002408, 1.2379196281729186, 0.8595303622902918, 1.3667651138368255, 0.9568778745885634, 1.0246771751199628, 0.9957985089923322, 1.000371408402751, 0.9782696463515212, 1.1249285821318267, 0.9847320268889127, 0.9947840609029124, 1.000146369855549, 0.9911896191364644, 1.0029971079730784, 0.0010001276052716797, 0.009897521843053017, 1.0092855962566256, 0.9534316178165079, 1.0132180989523172, 0.9378969202025911, 1.3609147744566426, 0.009998047846299483, 1.0099743463906283, 1.0010847884158471, 0.9897529380272942, 0.9346936012949519, 0.9929079518078741, 1.4345037816189576, 1.0444607822414733, 0.6512103340694056, 1.1920524357552582, 1.0191153847503358, 0.7988596821895139, 1.011064483357794, 0.9954701295998779, 0.23868183732550916, 2.120336806302392, 0.05578546651749731, 0.25407696560699966, 2.2425492726101233, 0.8568545119246167, 0.08623309882910132, 2.186403404438403, 1.1899364539257444, 0.0770038262900709, 1.010655762732568, 1.1910503458038944, 0.08155291432470854, 0.9957364195783464, 0.9957364195783464, 1.0096304666831382, 1.0, 0.9843370450265235, 0.9999999910259354, 1.0006044217881414, 0.9862882843207524, 1.0074030579228705, 0.09972668490842988, 0.09933113251952674, 1.0089092198401108, 1.003086765332726, 1.2528288914019847, 0.0, 0.7934363101685051, 0.10060848946019135, 0.010640959775338398, 0.9731171751456894, 0.9475043833145086, 1.0016029956748707, 1.0548969091889018]


function pro_callback()
    function cond(u,t,integrator)
        t == 2
    end

    function affect!(integrator)
        integrator.u[1] = 0.
    end
    return DiscreteCallback(cond, affect!)
end
cb = pro_callback()
"""
DiscreteCallback(condition,affect!;
                 initialize = INITIALIZE_DEFAULT,
                 finalize = FINALIZE_DEFAULT,
                 save_positions=(true,true))
"""
ssolve(prob) = solve(prob, AutoTsit5(Rosenbrock23()), callback = cb, tstops = [2.])


prob = ODEProblem(leish_model, [], tspan, [])
#sol = solve(prob, AutoTsit5(Rosenbrock23()), callback=cb, tstops=[2.0])
sol = ssolve(prob)

"""
using Plots
plot(sol)
plot(sol, vars = [total_ROS])
"""

#d = [p1, p2, d_TLR4, c_TLR4, d_NOTCH3, c_NOTCH3, p3, c_AKT2, p4, d_AKT2, c_TRAF6, p6, p8, p5, d_TRAF6, p7, d_MAP4K3, p9, c_MAP4K3, d_NFkB, p10, c_NFkB, c_IL1B, d_IL1B, p11, p12, c_TNFA, d_TNFA, p13, d_ANKRD1, c_ANKRD1, p14, p16, d_CREB, c_CREB, p15, c_IL10, d_IL10, p17, p18, c_IL10R, d_IL10R, d_STAT3, p19, c_STAT3, p20, c_NLRP12, d_NLRP12, p21, c_TRAF4, d_TRAF4, d_CCL24, p22, c_CCL24, d_TIFAB, c_TIFAB, p23, p24, d_TP53INP1, c_TP53INP1, p25, p26, c_FOS, d_FOS, c_NADP_oxi, p28, p27, d_NADP_oxi, d_ROS_cytos, c_ROS_cytos, p29, p30, p31, d_Leish_amas, c_Leish_amas, c_P2RX7, p32, d_P2RX7, p33, d_NFE2L2, c_NFE2L2, p35, p34, c_Glutathione, p36, d_Glutathione, d_ATP_ext, p38, c_ATP_ext_tr, p37, d_Adenosine, c_Adenosine, p39, c_ADORA2B, d_ADORA2B, p40, d_ATP_cytos, p41, c_ATP_cytos, c_Glycolysis, p42, d_Glycolysis, c_Pyruvate, d_Pyruvate, p43, p44, c_Succinate, d_Succinate, c_TCA, p45, d_TCA, p46, d_QH2, c_QH2, p47, p48, d_ATP_Mito, o_ATP_Mito, d_ROS_Mito, o_ROS_Mito, p49, c_HIF1A, d_HIF1A, d_Lactate, p50, c_Lactate].=> [1.6851506641302463, 0.4973419382755824, 0.6092564462746396, 0.31091593625538966, 0.15785996932278398, 5.275069984621667, 1.696779105380262, 0.7900908465186443, 0.17876646278038333, 9.300643693906542, 0.44448015404034924, 0.13458532153682778, 0.12921238369595017, 1.4461820038929276, 0.463931686807207, 0.13457066908315915, 1.3495946102261536, 18.89985104643954, 0.2296864763492302, 1.3870935021465276, 1.307165068946876, 0.44988723413941933, 0.7998531343484689, 3.5778692381958943, 2.381888749652374, 0.6327770254550203, 1.2990092776250044, 0.9110623953387844, 1.2289326063144788, 0.6595232399944772, 0.17949620123638804, 0.049787068367863965, 2.8013191561769126, 3.5778950134071383, 6.48368268895, 3.747941485606478, 1.2433373737076652, 0.34867607685467344, 1.3195298335414356, 0.2348855620188548, 0.3108580858113887, 3.5400335832637797, 0.28965865193712137, 1.7055628280350117, 0.34850634262339375, 0.3670275044926732, 1.793072070380314, 0.692807206039348, 0.9660966103255929, 0.3294313765917402, 1.8694374920744283, 0.586259806079441, 1.3433034018420253, 1.1870193634484292, 0.7274992987329169, 1.3218679309639043, 0.1943201653179772, 1.292892030047574, 1.3842863082519827, 0.2129935369432559, 1.3575946753615242, 18.587379444780264, 11.72549609902516, 3.9190648597574214, 0.809176055033625, 0.7271957876339743, 0.311374811367648, 6.452559696666351, 1.4323184805614433, 0.3759835883330223, 1.7661904996038722, 0.4260914089692665, 0.47844545369538133, 1.2627195669437308, 0.12474174704108107, 0.6011298427003269, 0.46241386956045155, 0.7431382101640447, 6.360316230359563, 4.9902181693040495, 0.1853617779099729, 0.41110639408147953, 1.0409146429335918, 2.164886641064728, 4.622917044164585, 0.7873114899278895, 0.15678923778342355, 0.09043925118114059, 0.4114633915558642, 12.197561076249038, 0.9278954374662512, 11.812472242291134, 15.547054137110862, 3.853790869631821, 4.83263596397839, 0.46315564624414596, 1.0231582143236755, 0.801310806109139, 0.10310674072066298, 0.1193441520134334, 12.168844779991085, 0.46652467621981325, 1.6547358239322985, 1.8425062319656351, 1.5101767406434856, 0.3567368723394091, 0.4053995635312103, 20.085536923187657, 0.8283577767678385, 2.545905640029009, 0.11085130681835151, 0.9042182414984083, 0.2297567873953724, 4.802733173602746, 3.9759557578629083, 0.8995002307664544, 6.818205594497593, 1.3661438785738549, 1.580445343371811, 0.9104531524682519, 8.974067578681273, 1.1373747554291893, 0.252200576428817, 1.158638098005497, 2.6739999928370253, 0.985533456510566]#
# [22.74576667998031, 4.032806764683479, 94.7628046355689, 148.16602243396486, 1.6023330107598586, 1.1286471547607695, 0.9990853187806881, 9.404358673668744, 0.043045081432497634, 142.5310314987071, 0.27691249574763893, 0.7007579281235631, 0.007699422495917578, 0.2253364991540083, 0.5264681612079136, 0.03416310022589866, 0.062313252309383914, 11.316929493713404, 0.2238225461933729, 0.10824276060273931, 1.0298156161524583, 4.748911580561799, 0.1674153707509418, 0.7643738552177493, 1.0507163539374873, 0.05811828707900332, 0.5356516383636158, 0.18551648686073843, 1.1681150201272874, 1.475705005655072, 0.6915679000558228, 2.161714489875426, 0.46603545154181564, 0.006773865789082415, 5.3753073020918976, 0.021142516037888536, 0.18037026175419796, 0.5906653001221874, 0.38284471145062166, 0.15183881559645238, 1.2886564489793053, 0.8231147409772795, 1.894042728535325, 1.9060669584221697, 12.936653720835329, 0.023554221153851165, 1.1168370282089524, 0.02303372545129547, 0.6227786200259998, 0.7457106303470511, 19.761215139101434, 1.8758880169801486, 148.26122650807935, 0.1371261639889576, 1.3003635415268513, 6.588673636293449, 0.8719058191830338, 0.3178124714428213, 10.378135520006621, 0.009929414138418306, 0.24897873105940171, 4.143973984099965, 0.07824575515502184, 0.6485988177664875, 63.27082396663486, 3.480796605069179, 0.3709753491596777, 1.1628187350902026, 0.6518325332485712, 0.34650547904598394, 1.435933663333253, 0.608266623906916, 0.006737947058371154, 4.250390473721973, 0.08192251262803513, 0.059089965901881036, 2.530606124372998, 0.34324745341031787, 62.96069469488433, 0.06020996972002989, 2.607426071697558, 0.7213580184163669, 0.006737994868983994, 0.023355934636711314, 0.5870757118375378, 4.631060351934834, 5.2991978626185645, 0.21317162438749146, 0.20591756275632953, 2.140730256690726, 0.8532807928568876, 4.260154346615682, 2.6084340426341672, 0.2803212692336928, 0.5461654837879731, 0.4948387486094856, 0.18037488227563428, 0.6233735183841423, 0.10783771180880519, 0.03574414841078099, 0.472997653353775, 15.296283187694067, 9.412637399172167, 1.7681814726147633, 6.710613368777491, 0.6759303220672549, 1.2724014609958776, 0.27394577548630467, 20.553445848282976, 0.49045410863108196, 7.230121639016476, 6.578354888042883, 0.10964148844052801, 0.5891876360147966]   

function uninfected_sol(sol)
    u0 = copy(sol.prob.u0)
    u0[1] = 0.
    probnew = remake(sol.prob, u0 = u0)
    return ssolve(probnew)
end

solu = uninfected_sol(sol)
pprob = solu.prob;


ssol = deepcopy(sol)
ssol.u .= [0.1.*el for el in sol.u]



@parameters t 
    D = Differential(t)
    @variables total_ROS(t) TIFAB_INHIBITOR(t) PANX(t) DMRTA2(t)
    @variables Leish_promas(t) TLR4(t) NOTCH3(t) AKT2(t) TRAF6(t) MAP4K3(t) NFkB(t) IL1B(t) TNFA(t) ANKRD1(t) CREB(t) IL10(t) IL10R(t) STAT3(t) NLRP12(t) TRAF4(t) CCL24(t) TIFAB(t) TP53INP1(t) FOS(t) NADP_oxi(t) ROS_cytos(t) Leish_amas(t) P2RX7(t) NFE2L2(t) Glutathione(t) ATP_ext(t) Adenosine(t) ADORA2B(t) ATP_cytos(t) Glycolysis(t) Pyruvate(t) Succinate(t) TCA(t) QH2(t) ATP_Mito(t) ROS_Mito(t) HIF1A(t) Lactate(t) Glucose(t)                      
    @parameters p1 p2  p3 p4 p5 p6 p7 p8 p9 p10 p11 p12 p13 p14 p15 p16 p17 p18 p19 p20 p21 p22 p23 p24 p25 p26 p27 p28 p29 p30 p31 p32 p33 p34 p35 p36 p37 p38 p39 p40 p41 p42 p43 p44 p45 p46 p47 p48 p49 p50 p51 p52 p53 p54 p55 p56 p57 p60 p61 p62 p63 p64 p65 c_TLR4 d_TLR4 c_NOTCH3 d_NOTCH3 c_AKT2 d_AKT2 c_TRAF6 d_TRAF6 c_MAP4K3 d_MAP4K3 c_NFkB d_NFkB c_IL1B d_IL1B c_TNFA d_TNFA c_ANKRD1 d_ANKRD1 c_CREB p14 d_CREB c_IL10 d_IL10 c_IL10R d_IL10R c_STAT3 d_STAT3 c_NLRP12 d_NLRP12 c_TRAF4 d_TRAF4 c_CCL24 d_CCL24 c_TIFAB d_TIFAB c_TP53INP1 d_TP53INP1 c_FOS d_FOS c_NADP_oxi d_NADP_oxi c_ROS_cytos d_ROS_cytos c_Leish_amas d_Leish_amas c_P2RX7 d_P2RX7 c_NFE2L2 d_NFE2L2 c_Glutathione d_Glutathione c_ATP_ext_tr d_ATP_ext_tr c_Adenosine d_Adenosine c_ADORA2B d_ADORA2B c_ATP_cytos d_ATP_cytos c_Glycolysis d_Glycolysis c_Pyruvate d_Pyruvate c_Succinate d_Succinate c_TCA d_TCA c_QH2 d_QH2 o_ATP_Mito d_ATP_Mito o_ROS_Mito d_ROS_Mito c_HIF1A d_HIF1A c_Lactate d_Lactate
    @parameters tftf c_PT nftf d_TI nftf2 nftf3 k38 v38 kt4t6
    @parameters p45_prop p38_prop p44_prop p60_prop p37_prop p1_prop amas_param
    @parameters p5_effective p47_effective p43_effective kntr
    @parameters c_TLR4a dTLR4a c_P2RX7a dP2RX7a lpst nftf4
    @parameters c_NT5E p65 p66 p67 d_NT5E p68 c_ADORA2Ba i_ADAd pcrebtr c_PANX n_ext_tr d_PANX d_ATP_ext c_PANXa d_PANXa d_ADORA2Ba
    @variables TLR4a(t) P2RX7a(t) ADORA2Ba(t) PANXa(t) NT5E(t)



function pplot(sol, vars; legend=true)
    rel_(x,y) = (x, 0.1*y)
    p = plot()
    for el in vars
        plot!(p, sol, vars=(rel_, 0, el), 
        xlabel = "time (hours)",
        ylabel = "fold change",
        fontsize = 24, 
        tickfontsize = 20,
        guidefontsize = 24,
        legendfontsize = 20,
        legend=legend,
        linewidth = 3,
        label = el |> Symbol |> String)
    end
    return p
end

# data where map4k3 etc are on the right side
# (c_TNFA => 0.17711069487463885, p66 => 0.04849702735458906, p7 => 0.00331250961981994, c_MAP4K3 => 0.030890621464169734, c_Glycolysis => 0.3860398317472236, c_CCL24 => 0.0013302073600111074, p65 => 0.006238013016637023, p27 => 0.053739079484785075, p48 => 0.011500540899873261, c_IL1B => 0.06640260521540217, c_QH2 => 0.03652462660131678, p44 => 0.6916583914653044, p57 => 0.2960050402430405, c_NLRP12 => 0.0017816169967584164, n_ext_tr => 0.03398967644505904, c_ADORA2B => 1.7691380427530543, p9 => 124.70832580128923, p55 => 0.07350082280251312, c_ADORA2Ba => 0.02954317115226186, p51 => 0.13435845686444034, c_FOS => 0.03558235880850039, p24 => 0.3095041261961973, p11 => 0.8859758625402191, p34 => 0.682694732744293, p45 => 0.688637303290571, v38 => 5.942095443579796, c_IL10 => 0.02437419687702852, d_ROS_Mito => 0.2051345926074583, c_P2RX7a => 0.03765425728675758, p17 => 10.016672399300923, c_NT5E => 0.05036057829416502, p67 => 0.45404438947824877, c_PANXa => 0.07247157148769658, p13 => 0.9854556665170479, p18 => 1.6892029428782174, p5 => 131.2334011019076, p10 => 1.5065867967115907, p26 => 0.09831666719755451, p28 => 0.013952254989386018, kilp2r => 0.5217207373157222, nftf3 => 0.2960050402430311, p62 => 0.9002832409799281, p12 => 0.00486882208946424, kntr => 0.25273808174423157, p43 => 0.3007817519465013, p47 => 84.1137387307853, o_ATP_Mito => 0.290422353761523, p3 => 0.03946873202158752, i_ADAd => 1.6906896247539525, k38 => 0.08029240452830337, c_TIGAR => 0.000999627511595467, p61 => 0.05637770548219331, p19 => 0.15505782944384988, p64 => 3.0243155457606767, p22 => 0.15868156209290524, p53 => 0.029983675122442082, p45_prop => 15.264757911887193, p38 => 0.05441178443016183, pcrebtr => 0.5114996328746614, p46 => 0.010192647928840089, c_NADP_oxi => 1.7801604216979987, p33 => 46.55738689967973, c_CREB => 0.05827312651583343, c_STAT3 => 0.0035992629853510774, p32 => 0.4661212726338868, p49 => 0.4848237065069543, c_NFE2L2 => 0.3925610657810263, c_NOTCH3 => 0.00033566824199613267, c_TLR4 => 0.029440505529164936, c_P2RX7 => 2.723858080202736, c_Glutathione => 21.023334809171164, p44_prop => 0.03328571615155131, k_PANXa => 0.9230112030990916, p20 => 0.15445679709942917, c_HIF1A => 9.999311453420683e-5, p35 => 6.382427226260181, c_PANX => 0.2459712553696118, c_TRAF6 => 0.9542685942334399, nftf4 => 0.27721183610481825, c_Succinate => 0.1929468818062953, p36 => 0.10280460031485177, p60_prop => 2.3995822521276327, c_TLR4a => 46.097144663823116, katppnx => 0.29091523254149654, c_NFkB => 0.15869490594327212, p15 => 0.04107686815335002, lpst => 7.1042423762035405, p68 => 0.007174729517102754, p60 => 0.09720027605300285, p21 => 0.03337078831630774, p2 => 16.667358501262584, p37 => 0.9312407932940622, kadocreb => 25.405741658870983, p16 => 0.3091826197724708, c_Lactate => 0.5095557168296283, p41 => 1.8697657117343178, p50 => 0.0006908837641331995)

# high but going to good minimum
# (c_TNFA => 0.17773150064274099, p66 => 0.04517194338985254, p7 => 0.0034217241274941703, c_MAP4K3 => 0.0308904583314024, c_Glycolysis => 0.38649979390772476, c_CCL24 => 0.0013301955468889566, p65 => 0.006228418544799348, p27 => 0.05374176436266853, p48 => 0.011504203523922242, c_IL1B => 0.06647022441876242, c_QH2 => 0.03659548317511372, p44 => 0.6739697104503783, p57 => 0.2960050402430405, c_NLRP12 => 0.0017816154983128672, n_ext_tr => 0.0337487180422504, c_ADORA2B => 1.737328958959711, p9 => 124.72033148610392, p55 => 0.07349503073366129, c_ADORA2Ba => 0.029530156015045023, p51 => 0.14644698894248617, c_FOS => 0.03555183448265886, p24 => 0.36617778767641784, p11 => 0.8969253151688653, p34 => 0.6838634478164584, p45 => 0.667192987499372, v38 => 5.982122767408682, c_IL10 => 0.0243734029958966, d_ROS_Mito => 0.2047255272056182, c_P2RX7a => 0.03765425731126283, p17 => 10.045577760078375, c_NT5E => 0.04995887682804937, p67 => 0.47777271499840107, c_PANXa => 0.07247484566876945, p13 => 1.0042181746098886, p18 => 1.6895099637437208, p5 => 196.68551307696467, p10 => 1.4473781973527478, p26 => 3.8813574931001464, p28 => 0.013950737947562727, kilp2r => 0.5217174450220875, nftf3 => 0.2960050402430311, p62 => 0.9030770004891222, p12 => 0.004872416958925757, kntr => 0.25288114756667235, p43 => 0.29951392137732497, p47 => 83.80090319002345, o_ATP_Mito => 0.2904272641783934, p3 => 0.039463609275909826, i_ADAd => 1.9132015172747774, k38 => 0.08028849084087432, c_TIGAR => 0.0009996006794867347, p61 => 0.056429845656921024, p19 => 0.15754406772166857, p64 => 3.1485549454134927, p22 => 0.15882904369679016, p53 => 0.03008444579450862, p45_prop => 15.093148638169891, p38 => 0.05441663710919131, pcrebtr => 0.5154959667133796, p46 => 0.009536138024801232, c_NADP_oxi => 1.7802946597360545, p33 => 46.55736572745007, c_CREB => 0.0581656281835824, c_STAT3 => 0.003599391684991601, p32 => 0.46586280605184016, p49 => 0.4806822413134203, c_NFE2L2 => 0.39261255338891987, c_NOTCH3 => 0.0003356600323953944, c_TLR4 => 0.029424601374226866, c_P2RX7 => 2.726010132492544, c_Glutathione => 21.098799953324697, p44_prop => 0.030266780758312673, k_PANXa => 0.923634308922684, p20 => 0.15000112110971145, c_HIF1A => 9.999314813577677e-5, p35 => 6.367942992112294, c_PANX => 0.24596249720673624, c_TRAF6 => 0.9856466882807597, nftf4 => 0.27721183610481825, c_Succinate => 0.19298550409223894, p36 => 0.10245499603899533, p60_prop => 2.3999078631650854, c_TLR4a => 47.96831832396569, katppnx => 0.2908585420376346, c_NFkB => 0.15957294058586777, p15 => 0.045632650408155784, lpst => 7.123482265995411, p68 => 0.00795966800918505, p60 => 0.09720027605300285, p21 => 0.03330440134082823, p2 => 16.350443315693138, p37 => 0.9310511309819312, kadocreb => 27.062064975547358, p16 => 0.3399262358412397, c_Lactate => 0.5177829250615932, p41 => 1.8682407969811048, p50 => 0.0006887534074160475)
# (c_TNFA => 0.17846735322384444, p66 => 0.04342614165822589, p7 => 0.003504657141845875, c_MAP4K3 => 0.030890366122447634, c_Glycolysis => 0.38674093414805527, c_CCL24 => 0.0013301846247640986, p65 => 0.006219632590053168, p27 => 0.05374256523458298, p48 => 0.01150723933703005, c_IL1B => 0.06655586941299121, c_QH2 => 0.03663794644080411, p44 => 0.6775690584767183, p57 => 0.2960050402430405, c_NLRP12 => 0.001781605310074353, n_ext_tr => 0.03354382105065599, c_ADORA2B => 1.7121803153044994, p9 => 124.72506931441437, p55 => 0.07348877313068167, c_ADORA2Ba => 0.02952278378145174, p51 => 0.16213077096313355, c_FOS => 0.03552262696576689, p24 => 0.4100963211684013, p11 => 0.9235138786187845, p34 => 0.6828345881931165, p45 => 0.6495740610607666, v38 => 6.005786377373341, c_IL10 => 0.024372585682175547, d_ROS_Mito => 0.20351359087364607, c_P2RX7a => 0.037654257352266296, p17 => 10.070319726910274, c_NT5E => 0.0497089790384681, p67 => 0.48742758440635264, c_PANXa => 0.07247664094265367, p13 => 1.0452359601511654, p18 => 1.690153989143177, p5 => 321.03802382395537, p10 => 1.415760550049881, p26 => 3.6937195430746512, p28 => 0.013950218249174098, kilp2r => 0.5217136672824223, nftf3 => 0.2960050402430311, p62 => 0.8984801726498975, p12 => 0.0048769518151495165, kntr => 0.2532969152046734, p43 => 0.2986677934160808, p47 => 83.52655221895832, o_ATP_Mito => 0.2904310771049566, p3 => 0.039456495111495585, i_ADAd => 2.050235628656335, k38 => 0.080287058550009, c_TIGAR => 0.0009995806761041535, p61 => 0.056547717606946095, p19 => 0.15934827713592178, p64 => 3.3979456578324956, p22 => 0.1588843429307255, p53 => 0.03017401006638361, p45_prop => 14.94021887373234, p38 => 0.054427577646665934, pcrebtr => 0.5192479726822092, p46 => 0.009088055433337182, c_NADP_oxi => 1.7803456176735442, p33 => 46.55733702059851, c_CREB => 0.058097870333082176, c_STAT3 => 0.0035994683235347413, p32 => 0.4656848958331535, p49 => 0.4738662340575319, c_NFE2L2 => 0.3925901350677167, c_NOTCH3 => 0.0003356504290827142, c_TLR4 => 0.029403603797296327, c_P2RX7 => 2.727570247195351, c_Glutathione => 21.112000907716943, p44_prop => 0.02869289244331278, k_PANXa => 0.9255842538066275, p20 => 0.14645749666714697, c_HIF1A => 9.999316253969438e-5, p35 => 6.374299075706216, c_PANX => 0.24594918255664208, c_TRAF6 => 1.0403170291974295, nftf4 => 0.27721183610481825, c_Succinate => 0.19301732225681395, p36 => 0.10239586474536876, p60_prop => 2.4004008561522143, c_TLR4a => 51.90403493137989, katppnx => 0.2907404459081989, c_NFkB => 0.1605486760761897, p15 => 0.04923337985222783, lpst => 7.166726415094045, p68 => 0.008522780375887004, p60 => 0.09720027605300285, p21 => 0.03334459602177571, p2 => 15.394429901509811, p37 => 0.9306605850970209, kadocreb => 28.063887240753882, p16 => 0.35520127800313095, c_Lactate => 0.5220109351777353, p41 => 1.8816375537462984, p50 => 0.0006873220771115619)
# (c_TNFA => 0.17915106263786917, p66 => 0.04238978417636204, p7 => 0.003533208672336386, c_MAP4K3 => 0.030890321024197566, c_Glycolysis => 0.38689457534289945, c_CCL24 => 0.0013301705148163687, p65 => 0.006213859551574709, p27 => 0.05374175000812617, p48 => 0.011510176305932446, c_IL1B => 0.06663542351678944, c_QH2 => 0.036661789694723286, p44 => 0.6853901170579313, p57 => 0.2960050402430405, c_NLRP12 => 0.0017815676959236134, n_ext_tr => 0.03333681266628527, c_ADORA2B => 1.6868992193934078, p9 => 124.72746967662692, p55 => 0.07348055639458521, c_ADORA2Ba => 0.029519157368351232, p51 => 0.17747469698387475, c_FOS => 0.03550068009280518, p24 => 0.4461260225068474, p11 => 0.9679922365456571, p34 => 0.6794956899251825, p45 => 0.6337329144909444, v38 => 6.018062458723121, c_IL10 => 0.0243715971215366, d_ROS_Mito => 0.20193267001568918, c_P2RX7a => 0.037654257464782584, p17 => 10.092643546562098, c_NT5E => 0.04952756172422105, p67 => 0.4888559775242829, c_PANXa => 0.07247774364474638, p13 => 1.1136387644813428, p18 => 1.6911777327883764, p5 => 466.11500639589457, p10 => 1.434671864985523, p26 => 3.4656571094829807, p28 => 0.01395064290824603, kilp2r => 0.521709484848073, nftf3 => 0.2960050402430311, p62 => 0.8939340346050423, p12 => 0.004881047702918191, kntr => 0.25342559918254814, p43 => 0.29803731982414466, p47 => 83.24930412246623, o_ATP_Mito => 0.29043450930812775, p3 => 0.039447078189369114, i_ADAd => 2.1111897171781147, k38 => 0.08028836100783956, c_TIGAR => 0.0009995641982199985, p61 => 0.05673786557487371, p19 => 0.15987806174211627, p64 => 3.5094247257996347, p22 => 0.1588890807013013, p53 => 0.03026552377364522, p45_prop => 14.792684872648039, p38 => 0.05444514006383331, pcrebtr => 0.5234161629177002, p46 => 0.008738827120472567, c_NADP_oxi => 1.7803062236562803, p33 => 46.55730997680666, c_CREB => 0.058056642705242474, c_STAT3 => 0.003599444997184061, p32 => 0.46560668138918543, p49 => 0.4666299303413133, c_NFE2L2 => 0.3924806759014832, c_NOTCH3 => 0.00033563832727311743, c_TLR4 => 0.0293904591450431, c_P2RX7 => 2.72824681289843, c_Glutathione => 21.04127788856341, p44_prop => 0.027871071228380447, k_PANXa => 0.9289023765813277, p20 => 0.14477288750232192, c_HIF1A => 9.999317553288546e-5, p35 => 6.403858620568595, c_PANX => 0.24592976077923237, c_TRAF6 => 1.0610174108237767, nftf4 => 0.27721183610481825, c_Succinate => 0.19304675673554464, p36 => 0.10272406438499906, p60_prop => 2.4011455095452594, c_TLR4a => 53.59311381712601, katppnx => 0.29055325163837586, c_NFkB => 0.16137615260010912, p15 => 0.05218772017886823, lpst => 7.194331346975842, p68 => 0.008893632575795347, p60 => 0.09720027605300285, p21 => 0.033504773053034516, p2 => 15.127489516184518, p37 => 0.9300427158846557, kadocreb => 28.530328802589903, p16 => 0.35808659715279295, c_Lactate => 0.5235243809616178, p41 => 1.8962411327751634, p50 => 0.0006864250604965238)
# (c_TNFA => 0.17958844985488492, p66 => 0.04173824611472792, p7 => 0.0034962963462409125, c_MAP4K3 => 0.030890317105164246, c_Glycolysis => 0.38707609644011237, c_CCL24 => 0.0013301569505183878, p65 => 0.00620998765992486, p27 => 0.053740168006046564, p48 => 0.01151298009588505, c_IL1B => 0.06668060480606014, c_QH2 => 0.03667608063859358, p44 => 0.6908516959914789, p57 => 0.2960050402430405, c_NLRP12 => 0.0017815190168781242, n_ext_tr => 0.034142084588570785, c_ADORA2B => 1.671544384881604, p9 => 124.55667480714371, p55 => 0.07347138232709109, c_ADORA2Ba => 0.029519810407590184, p51 => 0.18798310957479106, c_FOS => 0.03548351541133592, p24 => 0.4772391587208759, p11 => 1.0016037682362526, p34 => 0.6763557212520378, p45 => 0.6268949043869078, v38 => 6.019160564290205, c_IL10 => 0.02437058077120796, d_ROS_Mito => 0.20082001121043555, c_P2RX7a => 0.0376542576098504, p17 => 10.116461795278694, c_NT5E => 0.04939037960802727, p67 => 0.4864652419495308, c_PANXa => 0.07871162053166471, p13 => 1.1723946333558517, p18 => 1.5449172358558485, p5 => 495.9499324496722, p10 => 1.4623235774278849, p26 => 3.2542244620812957, p28 => 0.013951405847257075, kilp2r => 0.5217064888698909, nftf3 => 0.2960050402430311, p62 => 0.8925974685367192, p12 => 0.00488324884480349, kntr => 0.2535394994318715, p43 => 0.2974353826885147, p47 => 82.98122655449939, o_ATP_Mito => 0.29043763955328633, p3 => 0.03943737040029979, i_ADAd => 2.1179186818659597, k38 => 0.08028860990976959, c_TIGAR => 0.0009995502442559233, p61 => 0.037486490123026225, p19 => 0.1603469745243092, p64 => 3.486414489721744, p22 => 0.15888247549517046, p53 => 0.030354712456381553, p45_prop => 14.71024811383598, p38 => 0.06263375791910435, pcrebtr => 0.4793862100269086, p46 => 0.008451610093206323, c_NADP_oxi => 1.7802377916975924, p33 => 46.55729572872022, c_CREB => 0.058060248157720096, c_STAT3 => 0.003599455578755935, p32 => 0.46549962713848286, p49 => 0.4622794450343251, c_NFE2L2 => 0.3923719477562623, c_NOTCH3 => 0.0003356253272856076, c_TLR4 => 0.029392842526154008, c_P2RX7 => 2.7292382941946305, c_Glutathione => 20.961464595458608, p44_prop => 0.027372577640254844, k_PANXa => 0.4640055226154774, p20 => 0.14418404933521728, c_HIF1A => 9.999320283866138e-5, p35 => 6.433034436644761, c_PANX => 0.2461891064749431, c_TRAF6 => 1.0791379509995236, nftf4 => 0.27721183610481825, c_Succinate => 0.19306460575929793, p36 => 0.10309630183224176, p60_prop => 2.401983618465961, c_TLR4a => 53.64039817631292, katppnx => 0.3194163316902908, c_NFkB => 0.1618992969373037, p15 => 0.04976309383274883, lpst => 7.20053609506979, p68 => 0.00905653952797136, p60 => 0.09720027605300285, p21 => 0.03366210056958719, p2 => 14.848179925369138, p37 => 1.0237147167737317, kadocreb => 28.443653567382693, p16 => 0.35910846484410847, c_Lactate => 0.523838073938223, p41 => 1.8850417233158736, p50 => 0.0006858442151653664)

# (c_TNFA => 0.2992212332736053, p66 => 0.03166811737374393, p7 => 0.0016145628142832903, c_MAP4K3 => 0.0004553849857202269, c_Glycolysis => 0.18597120191557887, c_CCL24 => 0.007370562493048959, p65 => 0.032595014512569714, p27 => 0.10256943516805336, p48 => 0.002793876090061892, c_IL1B => 0.06699031029902959, c_QH2 => 0.006859662466510459, p44 => 0.6548065323118255, p57 => 0.0396520541942572, c_NLRP12 => 3.051840961842059e-5, n_ext_tr => 0.017776283512253847, c_ADORA2B => 1.6047650312518673, p9 => 378.46721071239716, p55 => 0.017831530268504932, c_ADORA2Ba => 0.8720109626042478, p51 => 0.19114049226600527, c_FOS => 0.013933059966210056, p24 => 0.6135482670134793, p11 => 1.0503407664819007, p34 => 0.4563484069124027, p45 => 0.5953437547686098, v38 => 3.1866216198111843, c_IL10 => 0.3102978491971354, d_ROS_Mito => 0.2077701134352123, c_P2RX7a => 0.9775897737911579, p17 => 43.56745717504932, c_NT5E => 0.005503009382222695, p67 => 0.42234929601553517, c_PANXa => 0.42924898594292915, p13 => 1.2912925511461921, p18 => 1.563727622141419, p5 => 827.3809288151076, p10 => 1.7539357930531905, p26 => 0.29796105375756526, p28 => 2.0113724102561273e-5, kilp2r => 1.6053935251925942, nftf3 => 0.2583805003004171, p62 => 0.8837390016085158, p12 => 4.0194776404743524e-5, kntr => 1.6498026929783631, p43 => 0.1787181307592393, p47 => 49.53992496445898, o_ATP_Mito => 0.6350307117986579, p3 => 0.038242023751332475, i_ADAd => 1.3531228619737445, k38 => 0.0036879353126861476, c_TIGAR => 0.017670845606389592, p61 => 0.5199334814388278, p19 => 0.16310223504818616, p64 => 3.2675300132642078, p22 => 0.15298491619638535, p53 => 0.33539471037771645, p45_prop => 14.002015025394345, p38 => 8.005503778295486, pcrebtr => 0.19034335753262602, p46 => 0.008192370692610283, c_NADP_oxi => 1.4026314281535226, p33 => 455.1250307726686, c_CREB => 0.0008781809355768653, c_STAT3 => 0.00012724378834914362, p32 => 0.33179605483973795, p49 => 0.48149218748199124, c_NFE2L2 => 0.7906666320283957, c_NOTCH3 => 0.0040290986652353165, c_TLR4 => 0.0246186995054026, c_P2RX7 => 2.2416937105411865, c_Glutathione => 24.81802488026031, p44_prop => 0.03156117483922607, k_PANXa => 0.9472653298142034, p20 => 0.1334276814569747, c_HIF1A => 1.671686686529402e-5, p35 => 6.952807739247642, c_PANX => 0.08145765735892072, c_TRAF6 => 1.1645829736001982, nftf4 => 2.2236984759864438, c_Succinate => 0.1935895355239603, p36 => 0.13842162432303012, p60_prop => 3.794381854144336, c_TLR4a => 43.31068313254, katppnx => 0.20758713521651928, c_NFkB => 0.02910334537854698, p15 => 0.050040327812502734, lpst => 13.02415583146698, p68 => 0.013875677200603138, p60 => 0.5145457671266668, p21 => 0.024422902163053213, p2 => 17.327125924037958, p37 => 0.9459188309577241, kadocreb => 22.367558021835933, p16 => 0.3111200950202653, c_Lactate => 0.3270540691633931, p41 => 1.8998747163747796, p50 => 0.0004606532894124772)